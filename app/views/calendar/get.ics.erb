BEGIN:VCALENDAR
X-WR-CALDESC:<%= @secret %>
X-WR-CALNAME:<%= @secret %>
X-WR-TIMEZONE:Europe/Berlin
CALSCALE:GREGORIAN
PRODID:-//htwk-cal.enno-projects.de//ENNOCAL 1.7//DE
VERSION:2.0
<% @events.each do |event| %>
BEGIN:VEVENT
DTSTAMP:<%= @now %>
DTSTART;TZID=Europe/Berlin:<%= event[:start] %>
DTEND;TZID=Europe/Berlin:<%= event[:end] %>
SUMMARY:<%= event[:summary].html_safe %>
LOCATION:<%= event[:location] %>
SEQUENCE:0
DESCRIPTION: <%= event[:description] %>
UID:<%= event[:uid] %>
END:VEVENT
<% end
-%>BEGIN:VTIMEZONE
TZID:Europe/Berlin
BEGIN:STANDARD
DTSTART:19701025T030000
RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU
TZNAME:CET
TZOFFSETFROM:+0200
TZOFFSETTO:+0100
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:19700329T020000
RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU
TZNAME:CEST
TZOFFSETFROM:+0100
TZOFFSETTO:+0200
END:DAYLIGHT
END:VTIMEZONE
END:VCALENDAR